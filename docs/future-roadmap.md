# 拡張の展望・ロードマップ

## 短期的な改善（1-3ヶ月）

### テスト基盤の整備

#### ユニットテスト導入
- **対象**: `services/gameLogic.ts`、`services/ranking.ts`
- **フレームワーク**: Vitest（Viteとの親和性が高い）
- **優先度**: 高
- **メリット**:
  - 問題生成ロジックの正確性保証
  - リファクタリング時の安全性向上
  - バグの早期発見

#### E2Eテスト導入
- **対象**: ゲームフロー全体（Start → Countdown → Game → End → Ranking）
- **フレームワーク**: Playwright または Cypress
- **優先度**: 中
- **メリット**:
  - ユーザーシナリオの自動検証
  - リグレッション防止

### アクセシビリティ改善

#### キーボード操作対応
- **実装内容**:
  - 数字キー（0-9）で数字入力
  - 演算子キー（+、-、*、/）で演算子入力
  - Enterキーで判定
  - Backspaceで最後の入力を削除
- **優先度**: 高
- **メリット**: 入力速度の向上、ユーザビリティ向上

#### スクリーンリーダー対応
- **実装内容**:
  - ARIA属性の追加
  - セマンティックHTML の使用
  - フォーカス管理の改善
- **優先度**: 中
- **メリット**: 視覚障害者でもプレイ可能

### パフォーマンス最適化

#### React.memo の活用
- **対象コンポーネント**:
  - `ProblemDisplay`
  - `InputDisplay`
  - `MessageArea`
- **優先度**: 低
- **メリット**: 不要な再レンダリング防止

#### Tone.js のローカルビルド化
- **現状**: CDN経由で読み込み
- **改善**: npm パッケージとして管理
- **優先度**: 中
- **メリット**:
  - オフライン動作可能
  - ビルド時の最適化
  - バージョン固定

## 中期的な機能追加（3-6ヶ月）

### 難易度設定

#### 難易度レベルの追加
- **イージー**: 小さい数字のみ（0-5）、簡単な目標（0-5）
- **ノーマル**: 現在の仕様
- **ハード**: 大きい数字も含む（0-9）、複雑な目標（0-20）

#### カスタム問題数
- **実装内容**:
  - 5問、10問、20問から選択可能
  - 問題数に応じてスコア計算を調整
- **優先度**: 中

### ソーシャル機能

#### スコア共有
- **実装内容**:
  - Twitter/X シェアボタン
  - スコア画像の自動生成
  - ハッシュタグ対応（例: #四則パズル）
- **優先度**: 高
- **メリット**: バイラル性の向上

#### オンラインランキング
- **実装内容**:
  - バックエンド構築（Firebase Realtime Database または Supabase）
  - グローバルランキング表示
  - 週間/月間ランキング
- **優先度**: 中
- **課題**: サーバーコスト、セキュリティ対策

### プレイモードの追加

#### タイムアタックモード
- **実装内容**:
  - 制限時間内にできるだけ多くの問題を解く
  - 難易度が徐々に上昇
- **優先度**: 中

#### 対戦モード（ローカルマルチプレイ）
- **実装内容**:
  - 2人プレイヤーで同じ問題を解く
  - 早く解いた方が勝利
- **優先度**: 低

## 長期的なビジョン（6ヶ月以降）

### モバイルアプリ化

#### ネイティブアプリ展開
- **技術スタック**:
  - React Native（既存のReactコードを再利用）
  - Expo（ビルド・デプロイの簡素化）
- **プラットフォーム**: iOS、Android
- **優先度**: 高
- **メリット**:
  - オフライン動作
  - プッシュ通知
  - ストアでの配信

#### PWA（Progressive Web App）対応
- **実装内容**:
  - Service Worker の追加
  - マニフェストファイルの作成
  - オフラインキャッシュ
- **優先度**: 中
- **メリット**: インストール可能、オフライン動作

### AI 機能の統合

#### ヒント機能
- **実装内容**:
  - AIが最適な解答へのヒントを提供
  - 段階的なヒント表示（軽いヒント → 詳細なヒント）
- **技術**: Claude API または GPT-4 API
- **優先度**: 低

#### 問題生成の高度化
- **実装内容**:
  - AIによる「面白い」問題の生成
  - ユーザーの得意/不得意を学習して適切な難易度を提供
- **優先度**: 低

### 教育機能の追加

#### 学習モード
- **実装内容**:
  - 解答過程の可視化
  - 計算ステップの説明
  - 算数の基礎概念の解説
- **ターゲット**: 小学生の算数学習
- **優先度**: 中

#### 成績トラッキング
- **実装内容**:
  - プレイ履歴の記録
  - 正答率・平均時間の統計
  - 成長グラフの表示
- **優先度**: 中

### グローバル展開

#### 多言語対応の拡充
- **追加言語**:
  - 中国語（簡体字/繁体字）
  - スペイン語
  - フランス語
  - ドイツ語
- **優先度**: 低

#### 地域別ランキング
- **実装内容**:
  - 国別・地域別のランキング表示
  - タイムゾーン対応
- **優先度**: 低

## 技術的リファクタリング

### TypeScript 型定義の強化
- **実装内容**:
  - `any` 型の排除（特に Tone.js）
  - Tone.js の型定義ファイル（`.d.ts`）の作成
  - Zod などのランタイム型検証導入
- **優先度**: 中

### 状態管理ライブラリの導入
- **候補**:
  - Zustand（軽量、シンプル）
  - Jotai（Atomic State Management）
- **目的**: 状態管理の複雑化に対応
- **優先度**: 低（現状は App.tsx の props で十分）

### コンポーネントライブラリの導入
- **候補**:
  - Radix UI（ヘッドレスUI）
  - shadcn/ui（Tailwind CSS ベース）
- **目的**: UI の一貫性向上、開発速度向上
- **優先度**: 低

## デザイン改善

### ダークモード対応
- **実装内容**:
  - ライト/ダークテーマの切り替え
  - システム設定に追従
- **優先度**: 中

### アニメーション強化
- **実装内容**:
  - Framer Motion の導入
  - 問題遷移時のスムーズなアニメーション
  - スコア増加時のカウントアップアニメーション
- **優先度**: 低

### カスタムテーマ
- **実装内容**:
  - 色テーマのカスタマイズ
  - 背景画像の変更
  - フォントサイズの調整
- **優先度**: 低

## 収益化の検討

### 広告表示
- **実装方法**:
  - Google AdSense
  - ゲーム終了画面に表示
- **優先度**: 低
- **課題**: ユーザー体験への影響

### プレミアムプラン
- **実装内容**:
  - 広告なし
  - 追加のゲームモード
  - 詳細な統計情報
- **価格**: $2.99/月 または $19.99/年
- **優先度**: 低

### 買い切り型モバイルアプリ
- **価格**: $4.99（一回限りの購入）
- **内容**: 全機能アンロック
- **優先度**: 低

## まとめ

### 優先度マトリクス

| 優先度 | 短期（1-3ヶ月） | 中期（3-6ヶ月） | 長期（6ヶ月以降） |
|--------|----------------|----------------|------------------|
| **高** | ・テスト基盤<br>・キーボード操作 | ・スコア共有 | ・モバイルアプリ化 |
| **中** | ・Tone.jsローカル化<br>・スクリーンリーダー | ・難易度設定<br>・オンラインランキング | ・PWA対応<br>・学習モード |
| **低** | ・React.memo | ・対戦モード | ・AI機能<br>・カスタムテーマ |

### 推奨される実装順序

1. **テスト基盤の整備**（Vitest導入）
2. **キーボード操作対応**（ユーザビリティ向上）
3. **スコア共有機能**（バイラル性向上）
4. **Tone.js のローカルビルド化**（オフライン対応）
5. **難易度設定**（ユーザー層の拡大）
6. **モバイルアプリ化**（リーチの拡大）

この順序により、ユーザー体験を段階的に向上させながら、技術的な負債を減らし、将来的な拡張性を確保できます。
