# Ko-fi 完全ガイド - 四則（Shisoku）への寄付導入

このドキュメントは、Ko-fiを使った寄付機能の実装ガイドです。

## TL;DR

- **Ko-fi**: プラットフォーム手数料0%の寄付サービス
- **決済方法**: PayPalとStripe両方対応（両方接続推奨）
- **支援者の支払い**: クレジットカード、Apple Pay、Google Pay、PayPalなど
- **手数料**: 決済手数料のみ（実効約9%）
- **セットアップ**: 5〜15分

---

## Ko-fiとは

Ko-fiは、クリエイターが「コーヒー1杯分」の寄付を受け取れるプラットフォームです。

### 主な特徴

| 項目 | 詳細 |
|---|---|
| **プラットフォーム手数料** | 0%（チップ/寄付の場合） |
| **決済手数料** | 2.9% + $0.30（Stripe/PayPal） |
| **月額料金** | 無料 |
| **最低支払額** | なし |
| **入金タイミング** | 即座（Ko-fiを経由せず直接入金） |
| **対応通貨** | 多通貨対応 |

---

## 手数料の仕組み

### Q1: Ko-fiの決済手数料って何？

**A: Ko-fiではなく、決済会社（Stripe/PayPal）に支払う手数料です。**

```
支援者が$5を送る場合の内訳：

┌─────────────────────────────────────┐
│ 支援額: $5.00                       │
└─────────────────────────────────────┘
          ↓
┌─────────────────────────────────────┐
│ Ko-fi手数料: $0（0%）                │
│ ← Ko-fiには一切渡らない               │
└─────────────────────────────────────┘
          ↓
┌─────────────────────────────────────┐
│ 決済手数料: $0.45                    │
│ (2.9% + $0.30)                      │
│ ← Stripe/PayPalが受け取る            │
└─────────────────────────────────────┘
          ↓
┌─────────────────────────────────────┐
│ あなたの受取額: $4.55（91%）         │
└─────────────────────────────────────┘
```

### 決済手数料の詳細

| 決済サービス | 手数料率 | 固定手数料 | 合計（$5の場合） |
|---|---|---|---|
| **Stripe（米国）** | 2.9% | $0.30 | $0.45 |
| **PayPal（米国）** | 2.9% | $0.30 | $0.45 |
| **Stripe（日本）** | 3.6% | なし | $0.18 |
| **PayPal（日本）** | 3.6% | ¥40 | 約¥58 |

### なぜ決済手数料がかかるのか

決済サービス（Stripe/PayPal）が以下を提供するため：

1. **クレジットカード処理**
   - Visa、Mastercard、AMEXなどへの接続
   - 決済セキュリティ（PCI DSS準拠）
   - 不正検知システム

2. **国際送金インフラ**
   - 通貨換算
   - 国際送金の処理
   - 銀行との連携

3. **チャージバック対応**
   - 払い戻し処理
   - 紛争解決

### 他サービスとの手数料比較

**すべてのサービスで決済手数料は発生します**：

| サービス | プラットフォーム手数料 | 決済手数料 | **合計実効手数料** |
|---|---|---|---|
| **Ko-fi** | 0% | 2.9% + $0.30 | **約9%** |
| **GitHub Sponsors** | 0% | 2.9% + $0.30 | **約9%** |
| Buy Me a Coffee | 5% | 2.9% + $0.30 | **約14%** |
| Patreon | 5%〜12% | 2.9% + $0.30 | **約14〜21%** |

**結論**: Ko-fiは決済手数料しかかからないので、最も効率的。

---

## 決済方法の選択

### Q2: Ko-fiはPayPalのみ？Stripeもある？

**A: PayPalとStripe両方に対応しています。両方を同時に接続できます。**

### クリエイター側（あなた）の設定

| 決済サービス | 対応状況 | 特徴 |
|---|---|---|
| **PayPal** | ✅ デフォルト | - 日本で広く使われている<br>- 設定が簡単<br>- 即座に入金 |
| **Stripe** | ✅ オプション追加可能 | - クレジットカード直接決済<br>- Apple Pay、Google Pay対応<br>- より多くの決済手段 |
| **両方同時接続** | ✅ 推奨 | - 支援者の選択肢が最大化<br>- 片方が使えない人もカバー |

### 支援者が使える支払い方法

#### PayPal経由で支援する場合
- PayPalアカウント
- クレジットカード（Visa、Mastercard、Discover）
- デビットカード
- Venmo（米国のみ）
- 各国の銀行決済（Bancontact、Przelewy24など）

#### Stripe経由で支援する場合
- クレジットカード（直接入力）
- Apple Pay
- Google Pay
- Cash App（米国のみ）
- 各国の銀行決済

### 推奨設定

**✅ PayPalとStripe両方を接続する（最推奨）**

**理由**:
1. **支援者の利便性向上**
   - PayPalアカウントを持っていない人 → Stripeで支援
   - クレジットカードのみの人 → Stripeで支援
   - PayPal派の人 → PayPalで支援

2. **手数料は同じ**
   - PayPal: 2.9% + $0.30
   - Stripe: 2.9% + $0.30
   - どちらも実効手数料約9%

3. **リスク分散**
   - 片方がメンテナンス中でももう片方で受付可能

### 日本での利用

#### PayPal（日本）
- ✅ 問題なく利用可能
- ✅ 日本の銀行口座に出金可能
- ⚠️ 手数料: 3.6% + ¥40（国内取引）

#### Stripe（日本）
- ✅ 日本対応済み
- ✅ 個人事業主として登録可能
- ✅ 日本の銀行口座に出金可能
- ✅ 手数料: 3.6%（国内カード）

---

## 支援者側の支払い体験

### Q3: 支払う側は何で支払うの？

**A: クレジットカード、Apple Pay、Google Pay、PayPalなど、様々な方法で支払えます。**

### 支援の流れ

```
1. ゲーム画面で「Support on Ko-fi」ボタンをクリック
         ↓
2. Ko-fiのページが開く
         ↓
3. 支援額を選択（$3, $5, $10など）
         ↓
4. 支払い方法を選択 ← ここが重要！
         ↓
5. 支払い完了
```

### Ko-fi支援ページのイメージ

```
┌─────────────────────────────────────┐
│  Support [あなたのユーザー名]         │
├─────────────────────────────────────┤
│                                     │
│  支援額を選択:                       │
│  [ $3 ]  [ $5 ]  [ $10 ]  [カスタム]│
│                                     │
│  支払い方法:                         │
│  ┌─────────────────┐                │
│  │  💳 Pay with Card │  ← Stripe   │
│  └─────────────────┘                │
│  ┌─────────────────┐                │
│  │  🅿️ PayPal       │  ← PayPal   │
│  └─────────────────┘                │
│                                     │
└─────────────────────────────────────┘
```

### 支払い方法の詳細

#### 1. クレジットカード（Stripe経由）

**最もシンプル、アカウント不要**

```
入力項目:
- カード番号: 1234 5678 9012 3456
- 有効期限: 12/25
- CVC: 123
- 名義: TARO YAMADA
- 郵便番号（国による）

対応カード:
- Visa ✅
- Mastercard ✅
- American Express ✅
- JCB ✅（日本）
- Diners ✅

所要時間: 30秒
```

#### 2. Apple Pay（iPhone/Mac）

**最速、ワンタップ**

```
「Apple Pay」ボタンをタップ
    ↓
Face ID/Touch IDで認証
    ↓
完了

所要時間: 3秒
```

#### 3. Google Pay（Android）

```
「Google Pay」ボタンをタップ
    ↓
指紋認証/PIN入力
    ↓
完了

所要時間: 5秒
```

#### 4. PayPalアカウント

**既存のPayPalユーザー向け**

```
「PayPal」ボタンをクリック
    ↓
PayPalにログイン
    ↓
支払い確認
    ↓
完了

所要時間: 15秒
```

#### 5. PayPal（ゲスト決済、アカウント不要）

```
「PayPal」ボタンをクリック
    ↓
「アカウントを作成せずに支払う」を選択
    ↓
カード情報入力
    ↓
完了

所要時間: 45秒
```

### 日本のプレイヤーの場合

| 支払い方法 | 使いやすさ | 普及率 | 推奨度 |
|---|---|---|---|
| **クレジットカード（Stripe）** | ⭐⭐⭐⭐⭐ | 高 | 最推奨 |
| **Apple Pay** | ⭐⭐⭐⭐⭐ | 中（iPhone所持者） | 推奨 |
| **PayPal（ゲスト）** | ⭐⭐⭐⭐ | 中 | 推奨 |
| **Google Pay** | ⭐⭐⭐⭐ | 低 | 可 |
| **PayPalアカウント** | ⭐⭐⭐ | 低 | 可 |

**日本で最も使われるパターン**:
1. クレジットカード直接入力（Stripe）← 最多
2. Apple Pay（iPhoneユーザー）
3. PayPalゲスト決済

### 支援者側の手数料

**重要: 支援者は追加料金なし**

```
支援者が$5を支払う
    ↓
支援者の支払い: $5.00（そのまま）
    ↓
あなたの受取: $4.55（手数料控除後）
```

**つまり**:
- ✅ 支援者は表示された金額だけ支払う
- ✅ 手数料はあなた（受取側）が負担
- ✅ 支援者に追加費用なし

---

## セットアップ手順

### Phase 1: Ko-fiアカウント作成（5分）

1. **https://ko-fi.com にアクセス**
2. **「Sign Up」をクリック**
3. **基本情報入力**
   - メールアドレス
   - ユーザー名（例: `shisoku-game`）
   - パスワード
4. **プロフィール設定**
   - 表示名: 「四則（Shisoku）」
   - 説明文: 「数学パズルゲームの開発者です」
   - プロフィール画像
5. **完了**

### Phase 2: PayPal接続（3分）

```
Ko-fiダッシュボード
    ↓
「Payment」タブをクリック
    ↓
「Connect PayPal」をクリック
    ↓
既存のPayPalアカウントでログイン
または新規作成
    ↓
接続許可
    ↓
完了
```

### Phase 3: Stripe接続（10分）

```
Ko-fiダッシュボード
    ↓
「Payment」タブ
    ↓
「Connect Stripe」をクリック
    ↓
Stripeアカウント作成
    ↓
以下の情報を入力:
  - 事業形態: 個人事業主（Individual）
  - 氏名
  - 生年月日
  - 住所
  - 銀行口座情報
    - 銀行名
    - 支店コード
    - 口座番号
    ↓
本人確認書類アップロード
  - 運転免許証、パスポート、マイナンバーカードなど
    ↓
審査（通常1〜2営業日）
    ↓
完了
```

### Phase 4: ウィジェット設定（2分）

```
Ko-fiダッシュボード
    ↓
「Widget」タブ
    ↓
ウィジェットタイプ選択:
  - Floating Button（フローティングボタン）
  - Panel（パネル）
  - Button（シンプルボタン）
    ↓
カスタマイズ:
  - テキスト: 「☕ Support this game」
  - カラー: #29abe0（青）
    ↓
コードをコピー
    ↓
完了
```

---

## ゲームへの実装

### パターンA: シンプルなリンクボタン

```html
<!-- index.htmlまたはEndScreen.tsx -->
<a href='https://ko-fi.com/YOUR_USERNAME' target='_blank'>
  <img height='36' style='border:0px;height:36px;'
       src='https://storage.ko-fi.com/cdn/kofi2.png?v=3'
       border='0' alt='Buy Me a Coffee at ko-fi.com' />
</a>
```

### パターンB: フローティングボタン（右下固定）

```html
<!-- index.html の </body> の直前に追加 -->
<script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script>
<script type='text/javascript'>
  kofiwidget2.init('☕ Support this game', '#29abe0', 'YOUR_USERNAME');
  kofiwidget2.draw();
</script>
```

### パターンC: React コンポーネント

```tsx
// src/components/DonationButton.tsx
import { useEffect } from 'react';

interface DonationButtonProps {
  username: string;
  label?: string;
  color?: string;
}

export const DonationButton: React.FC<DonationButtonProps> = ({
  username,
  label = 'Support this game',
  color = '#29abe0'
}) => {
  useEffect(() => {
    const script = document.createElement('script');
    script.src = 'https://storage.ko-fi.com/cdn/widget/Widget_2.js';
    script.async = true;
    document.body.appendChild(script);

    script.onload = () => {
      // @ts-ignore
      if (window.kofiwidget2) {
        // @ts-ignore
        window.kofiwidget2.init(label, color, username);
        // @ts-ignore
        window.kofiwidget2.draw();
      }
    };

    return () => {
      document.body.removeChild(script);
    };
  }, [username, label, color]);

  return <div id="kofi-widget-container"></div>;
};
```

### パターンD: EndScreenに組み込む

```tsx
// src/components/EndScreen.tsx
import { DonationButton } from './DonationButton';

export const EndScreen: React.FC<EndScreenProps> = ({ /* props */ }) => {
  return (
    <div className="end-screen">
      {/* 既存のスコア表示など */}

      {/* 寄付セクション */}
      <div className="mt-8 text-center border-t pt-6">
        <p className="text-sm text-gray-600 dark:text-gray-400 mb-3">
          このゲームを気に入っていただけましたか？
        </p>

        <a
          href="https://ko-fi.com/YOUR_USERNAME"
          target="_blank"
          rel="noopener noreferrer"
          className="inline-block"
        >
          <img
            height="36"
            src="https://storage.ko-fi.com/cdn/kofi2.png?v=3"
            alt="Buy Me a Coffee at ko-fi.com"
            className="hover:opacity-80 transition-opacity"
          />
        </a>

        <p className="text-xs text-gray-500 dark:text-gray-400 mt-3">
          寄付は開発の継続に役立ちます ❤️
        </p>
      </div>
    </div>
  );
};
```

---

## 収益シミュレーション

### 前提条件

- 平均支援額: $5
- 支援者の支払い: $5.00
- あなたの受取: $4.55（手数料$0.45控除後）

### シナリオ1: 月間1万PV、支援率0.1%

```
月間ユーザー: 3,333人
支援者数: 3,333 × 0.1% = 3.3人 ≈ 3人
平均支援額: $5

月間収益:
支援総額: 3 × $5 = $15
手数料: $1.35（決済手数料のみ）
受取額: $13.65/月 ≈ ¥2,000/月
```

### シナリオ2: 月間10万PV、支援率0.2%

```
月間ユーザー: 33,333人
支援者数: 33,333 × 0.2% = 66.7人 ≈ 67人
平均支援額: $5

月間収益:
支援総額: 67 × $5 = $335
手数料: $30（決済手数料のみ）
受取額: $305/月 ≈ ¥45,000/月
```

### シナリオ3: 月間100万PV、支援率0.3%

```
月間ユーザー: 333,333人
支援者数: 333,333 × 0.3% = 1,000人
平均支援額: $5

月間収益:
支援総額: 1,000 × $5 = $5,000
手数料: $450（決済手数料のみ）
受取額: $4,550/月 ≈ ¥680,000/月
```

### 支援率の現実的な目安

| ゲーム品質 | 平均プレイ時間 | 支援率の目安 |
|---|---|---|
| 良い | 5分未満 | 0.05%〜0.1% |
| とても良い | 5〜10分 | 0.1%〜0.2% |
| 素晴らしい | 10分以上 | 0.2%〜0.5% |
| 極めて優秀 | リピートプレイ多数 | 0.5%〜1% |

---

## よくある質問（FAQ）

### Q: Ko-fiアカウントは無料ですか？

**A: 完全無料です。** 月額料金はかかりません。Ko-fi Goldプラン（$6/月）もありますが、基本機能は無料プランで十分です。

### Q: 支援を受け取るのに審査は必要ですか？

**A: PayPalは審査なし、Stripeは1〜2営業日の審査があります。** ただし、どちらも個人で簡単に通過できます。

### Q: 日本から支援を受け取れますか？

**A: 問題なく受け取れます。** PayPalもStripeも日本の銀行口座に出金可能です。

### Q: 支援金はいつ入金されますか？

**A: 即座に入金されます。** Ko-fiは資金を保持せず、直接あなたのPayPal/Stripeアカウントに入金されます。

### Q: 最低支援額は設定できますか？

**A: はい。** デフォルトは$3ですが、変更可能です。

### Q: 匿名での支援は可能ですか？

**A: 可能です。** 支援者は名前を非表示にできます。

### Q: 複数のゲームで同じKo-fiアカウントを使えますか？

**A: 使えます。** 1つのKo-fiアカウントで複数のプロジェクトをサポート可能です。

### Q: GitHub Pagesの規約に違反しませんか？

**A: 違反しません。** GitHub Pagesは寄付ボタンを明示的に許可しています。

---

## まとめ

### Ko-fiを選ぶべき理由

| 項目 | Ko-fi | 他サービス |
|---|---|---|
| プラットフォーム手数料 | ✅ 0% | 5%〜12% |
| 決済方法 | ✅ PayPal + Stripe | サービスによる |
| セットアップ時間 | ✅ 5〜15分 | 15分〜数日 |
| 月額料金 | ✅ 無料 | 無料〜$20 |
| 入金タイミング | ✅ 即座 | サービスによる |
| 日本対応 | ✅ 完全対応 | サービスによる |

### 次のステップ

1. **Ko-fiアカウント作成**（5分）
   - https://ko-fi.com

2. **PayPal接続**（3分）
   - 既存アカウントまたは新規作成

3. **Stripe接続**（10分）
   - 個人事業主として登録
   - 銀行口座情報入力

4. **ウィジェットコード取得**（2分）
   - シンプルボタンまたはフローティング

5. **ゲームに実装**（5分）
   - EndScreenにボタン追加
   - メッセージ追加

6. **GitHub Pagesにデプロイ**
   - 動作確認

**総所要時間: 約30分**

---

*最終更新: 2025-01-16*
